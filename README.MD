# âœ… Validador de Dados - ERP Director

<div align="center">
  <img src="assets/icone.ico" alt="Ãcone do Validador" width="128"/>
  
  **Ferramenta para validaÃ§Ã£o automatizada de dados entre sistemas legados e ERP Director**
  
  [![Python](https://img.shields.io/badge/Python-3.8%2B-blue.svg)](https://www.python.org/)
  [![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
  [![Status](https://img.shields.io/badge/Status-Ativo-brightgreen.svg)]()
</div>

---

## ğŸ“‹ Sobre o Projeto

O **Validador de Dados ERP Director** Ã© uma ferramenta desenvolvida para **acelerar e automatizar a validaÃ§Ã£o de dados** durante implantaÃ§Ãµes de ERP. Realiza comparaÃ§Ãµes precisas entre sistemas legados (Firebird, MySQL, SQL Server) e o banco de destino SQL Server do ERP Director.

### ğŸ¯ Objetivo Principal
Garantir **consistÃªncia, agilidade e rastreabilidade** na migraÃ§Ã£o de dados, reduzindo erros manuais e tempo de validaÃ§Ã£o durante implantaÃ§Ãµes.

---

## âš™ï¸ Principais Funcionalidades

### ğŸ”— **Conectividade Multi-Banco**
- Suporte completo para **Firebird**, **MySQL** e **SQL Server**
- ConexÃµes simultÃ¢neas para comparaÃ§Ã£o em tempo real
- ConfiguraÃ§Ã£o flexÃ­vel de credenciais por ambiente

### ğŸ“„ **Sistema de Regras AvanÃ§ado**
- Regras de validaÃ§Ã£o em arquivos **JSON externos**
- Suporte a **lÃ³gica condicional** e **normalizaÃ§Ã£o automÃ¡tica**
- ValidaÃ§Ã£o campo a campo com **mÃºltiplas fontes de dados**
- Templates em Excel para criaÃ§Ã£o visual de regras

### ğŸ“Š **ValidaÃ§Ã£o Inteligente**
- ComparaÃ§Ã£o **linha a linha** entre bancos
- NormalizaÃ§Ã£o automÃ¡tica de dados (CNPJ, CPF, IE, datas)
- DetecÃ§Ã£o de divergÃªncias com **status detalhado**
- ValidaÃ§Ã£o de chaves primÃ¡rias e campos obrigatÃ³rios

### ğŸ“¥ **ExportaÃ§Ã£o Completa**
- ExportaÃ§Ã£o automÃ¡tica para **Google Sheets**
- GeraÃ§Ã£o de relatÃ³rios locais em **Excel (.xlsx)** e **CSV**
- Logs detalhados com **rastreabilidade completa**
- Dashboards com **totais e estatÃ­sticas**

### ğŸ’¡ **Interface Moderna**
- Interface grÃ¡fica **intuitiva** para seleÃ§Ã£o de pipelines
- **Log ao vivo** durante execuÃ§Ã£o
- SeleÃ§Ã£o dinÃ¢mica de regras e configuraÃ§Ãµes
- Suporte a execuÃ§Ã£o via **terminal** ou **interface**

---

## ğŸ—ï¸ Arquitetura do Sistema

### ğŸ“ **Estrutura Modular**

```text
validacao_dados/
â”œâ”€â”€ ğŸ“‚ assets/                    # Recursos visuais
â”‚   â””â”€â”€ icone.ico                 # Ãcone da aplicaÃ§Ã£o
â”œâ”€â”€ ğŸ“‚ config/                    # ConfiguraÃ§Ãµes
â”‚   â”œâ”€â”€ credentials.py            # Credenciais dos bancos
â”‚   â””â”€â”€ google_credentials.json   # Credenciais Google Sheets
â”œâ”€â”€ ğŸ“‚ core/                      # NÃºcleo do sistema
â”‚   â”œâ”€â”€ ğŸ“‚ connectors/            # Conectores de banco
â”‚   â”‚   â”œâ”€â”€ firebird_connector.py
â”‚   â”‚   â”œâ”€â”€ mysql_connector.py
â”‚   â”‚   â””â”€â”€ sqlserver_connector.py
â”‚   â”œâ”€â”€ ğŸ“‚ pipelines/             # Pipelines de validaÃ§Ã£o
â”‚   â”‚   â”œâ”€â”€ firebird_to_sql.py
â”‚   â”‚   â”œâ”€â”€ mysql_to_sql.py
â”‚   â”‚   â””â”€â”€ base_pipeline.py
â”‚   â”œâ”€â”€ ğŸ“‚ reports/               # GeraÃ§Ã£o de relatÃ³rios
â”‚   â”‚   â”œâ”€â”€ google_sheets.py
â”‚   â”‚   â”œâ”€â”€ excel_exporter.py
â”‚   â”‚   â””â”€â”€ csv_exporter.py
â”‚   â”œâ”€â”€ validator.py              # â­ Motor de validaÃ§Ã£o
â”‚   â”œâ”€â”€ normalizadores.py         # â­ NormalizaÃ§Ã£o de dados
â”‚   â””â”€â”€ comparadores.py           # â­ Comparadores especializados
â”œâ”€â”€ ğŸ“‚ data/                      # Dados de entrada e saÃ­da
â”‚   â”œâ”€â”€ ğŸ“‚ input/                 # Templates e dados de entrada
â”‚   â”‚   â””â”€â”€ template_regras_clientes.xlsx
â”‚   â””â”€â”€ ğŸ“‚ output/                # Resultados da validaÃ§Ã£o
â”‚       â”œâ”€â”€ ğŸ“‚ jsons/             # Regras geradas
â”‚       â”œâ”€â”€ ğŸ“‚ excel/             # RelatÃ³rios Excel
â”‚       â””â”€â”€ ğŸ“‚ csv/               # RelatÃ³rios CSV
â”œâ”€â”€ ğŸ“‚ rules/                     # Regras de validaÃ§Ã£o
â”‚   â”œâ”€â”€ regras_clientes.json
â”‚   â”œâ”€â”€ regras_produtos.json
â”‚   â””â”€â”€ regras_fornecedores.json
â”œâ”€â”€ ğŸ“‚ utils/                     # UtilitÃ¡rios
â”‚   â”œâ”€â”€ gerar_jsons_de_planilha.py
â”‚   â”œâ”€â”€ database_utils.py
â”‚   â””â”€â”€ file_utils.py
â”œâ”€â”€ interface.py                  # ğŸ–¥ï¸ Interface grÃ¡fica
â”œâ”€â”€ main.py                       # ğŸ¯ ExecuÃ§Ã£o via terminal
â”œâ”€â”€ run_validador.bat             # ğŸš€ Iniciador da interface
â”œâ”€â”€ Rodar_regras_json.bat         # ğŸ”§ Gerador de regras
â”œâ”€â”€ requirements.txt              # ğŸ“¦ DependÃªncias
â””â”€â”€ README.md                     # ğŸ“š DocumentaÃ§Ã£o
```

### ğŸ§© **Componentes Principais**

| Componente | FunÃ§Ã£o | Tecnologia |
|------------|--------|------------|
| **ğŸ¯ Core Engine** | Motor principal de validaÃ§Ã£o | Python |
| **ğŸ”— Connectors** | Conectores multi-banco | PyODBC, Firebird, MySQL |
| **ğŸ“Š Validators** | LÃ³gica de comparaÃ§Ã£o | Pandas, NumPy |
| **ğŸ“„ Rules Engine** | Sistema de regras JSON | JSON, LÃ³gica condicional |
| **ğŸ“ˆ Reports** | GeraÃ§Ã£o de relatÃ³rios | Google Sheets API, OpenPyXL |
| **ğŸ–¥ï¸ Interface** | Interface grÃ¡fica | Tkinter |

---

## ğŸš€ InstalaÃ§Ã£o e ConfiguraÃ§Ã£o

### ğŸ“‹ **PrÃ©-requisitos**
- **Python 3.8+** instalado
- **Drivers de banco** configurados (ODBC, Firebird, MySQL)
- **Credenciais de acesso** aos bancos de dados
- **Conta Google** para exportaÃ§Ã£o (opcional)

### ğŸ› ï¸ **InstalaÃ§Ã£o**

#### 1ï¸âƒ£ **Preparar o Ambiente**

```powershell
# Clone o repositÃ³rio
git clone https://github.com/Pablo-Raizer/Validador-Dados.git
cd Validador-Dados

# Crie o ambiente virtual
python -m venv .venv

# Ative o ambiente virtual
.venv\Scripts\Activate.ps1

# Se houver erro de permissÃ£o
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser

# Instale as dependÃªncias
pip install -r requirements.txt
```

#### 2ï¸âƒ£ **Configurar Credenciais**

```python
# config/credentials.py
DATABASE_CONFIGS = {
    'firebird': {
        'host': 'localhost',
        'database': 'caminho/para/banco.fdb',
        'user': 'SYSDBA',
        'password': 'masterkey'
    },
    'mysql': {
        'host': 'localhost',
        'database': 'nome_banco',
        'user': 'root',
        'password': 'senha'
    },
    'sqlserver': {
        'server': 'localhost',
        'database': 'ERP_Director',
        'user': 'sa',
        'password': 'senha'
    }
}
```

#### 3ï¸âƒ£ **Configurar Google Sheets (Opcional)**

1. Acesse [Google Cloud Console](https://console.cloud.google.com/)
2. Crie um projeto e habilite Google Sheets API
3. Baixe o arquivo `credentials.json`
4. Renomeie para `google_credentials.json` e coloque em `config/`

---

## ğŸ“– Guia de Uso

### ğŸ¯ **ExecuÃ§Ã£o RÃ¡pida**

#### **Via Interface GrÃ¡fica** (Recomendado)
```bash
# Inicie a interface
run_validador.bat

# Ou execute diretamente
python interface.py
```

#### **Via Terminal**
```bash
# Execute validaÃ§Ã£o especÃ­fica
python main.py firebird_to_sql regras_clientes.json

# Com parÃ¢metros adicionais
python main.py mysql_to_sql regras_produtos.json --verbose
```

### ğŸ“„ **Criando Regras de ValidaÃ§Ã£o**

#### **MÃ©todo 1: Via Excel (Recomendado)**

1. Abra o template `data/input/template_regras_clientes.xlsx`
2. Preencha as regras conforme necessÃ¡rio
3. Execute o gerador:
   ```bash
   python utils/gerar_jsons_de_planilha.py
   ```

#### **MÃ©todo 2: CriaÃ§Ã£o Manual JSON**

```json
{
  "entidade": "cliente",
  "descricao": "ValidaÃ§Ã£o de dados de clientes",
  "primary_key": ["DFcod_cliente", "CHAVEPES"],
  "campos": [
    {
      "destino": "DFnome",
      "origem": "NOME",
      "normalizar": "texto",
      "obrigatorio": true,
      "descricao": "Nome do cliente"
    },
    {
      "destino": "DFcnpj_cpf",
      "origem": ["CNPJ", "CPF"],
      "condicao": {
        "coluna": "TIPOFISCAL",
        "valores": {
          "F": "CPF",
          "J": "CNPJ"
        }
      },
      "normalizar": "documento",
      "obrigatorio": true,
      "descricao": "Documento fiscal (CPF/CNPJ)"
    },
    {
      "destino": "DFinscr_estadual",
      "origem": "IE",
      "normalizar": "inscricao_estadual",
      "obrigatorio": false,
      "descricao": "InscriÃ§Ã£o estadual"
    },
    {
      "destino": "DFdata_inativacao",
      "origem": "DATADESATIVADO",
      "normalizar": "data",
      "obrigatorio": false,
      "descricao": "Data de inativaÃ§Ã£o"
    }
  ]
}
```

### ğŸ” **Tipos de NormalizaÃ§Ã£o DisponÃ­veis**

| Tipo | DescriÃ§Ã£o | Exemplo |
|------|-----------|---------|
| `texto` | NormalizaÃ§Ã£o bÃ¡sica de strings | Remove espaÃ§os, maiÃºsculas |
| `documento` | CPF/CNPJ | `123.456.789-01` â†’ `12345678901` |
| `inscricao_estadual` | IE | Remove caracteres especiais |
| `data` | Datas | `2023-12-31` â†’ `31/12/2023` |
| `numero` | Valores numÃ©ricos | `1,234.56` â†’ `1234.56` |
| `telefone` | NÃºmeros de telefone | `(11) 9999-9999` â†’ `11999999999` |
| `cep` | CEP | `01234-567` â†’ `01234567` |

### ğŸ“Š **Interpretando Resultados**

#### **Status de ValidaÃ§Ã£o**
- âœ… **Conforme**: Dados idÃªnticos apÃ³s normalizaÃ§Ã£o
- âŒ **Divergente**: DiferenÃ§as encontradas
- âš ï¸ **AtenÃ§Ã£o**: Campos nulos ou valores suspeitos
- ğŸ” **Investigar**: Regras condicionais nÃ£o atendidas

#### **LocalizaÃ§Ã£o dos Resultados**
- ğŸ“ **Local**: `data/output/` (Excel e CSV)
- â˜ï¸ **Online**: [Google Sheets](https://docs.google.com/spreadsheets/d/16u8KSsLNidNtlZ4daX2Vs-GALqgM7OvESHRpGB9VUI8)

---

## ğŸ”§ PersonalizaÃ§Ã£o e ExtensÃ£o

### ğŸ†• **Adicionando Nova Entidade**

1. **Crie o arquivo de regras**:
   ```json
   # rules/regras_nova_entidade.json
   {
     "entidade": "nova_entidade",
     "primary_key": ["id_campo"],
     "campos": [...]
   }
   ```

2. **Execute pela interface ou terminal**:
   ```bash
   python main.py firebird_to_sql regras_nova_entidade.json
   ```

### ğŸ”Œ **Adicionando Novo Conector**

1. **Crie o conector**:
   ```python
   # core/connectors/novo_banco_connector.py
   class NovoBancoConnector:
       def __init__(self, config):
           self.config = config
       
       def connect(self):
           # Implementar conexÃ£o
           pass
       
       def execute_query(self, query):
           # Implementar execuÃ§Ã£o
           pass
   ```

2. **Registre no sistema**:
   ```python
   # core/pipelines/novo_banco_to_sql.py
   from .base_pipeline import BasePipeline
   from ..connectors.novo_banco_connector import NovoBancoConnector
   
   class NovoBancoToSQLPipeline(BasePipeline):
       # Implementar pipeline
       pass
   ```

### ğŸ§ª **Adicionando Novo Normalizador**

```python
# core/normalizadores.py
def normalizar_custom(valor):
    """
    Novo normalizador personalizado
    """
    if not valor:
        return None
    
    # Implementar lÃ³gica de normalizaÃ§Ã£o
    return valor.strip().upper()

# Registrar no mapeamento
NORMALIZADORES = {
    'custom': normalizar_custom,
    # ... outros normalizadores
}
```

---

## ğŸ“ˆ Monitoramento e Logs

### ğŸ“Š **Logs Detalhados**
- **Interface**: Log ao vivo durante execuÃ§Ã£o
- **Terminal**: Output detalhado com timestamps
- **Arquivo**: Logs salvos em `data/output/logs/`

### ğŸ” **MÃ©tricas DisponÃ­veis**
- Total de registros processados
- Percentual de conformidade
- Tempo de execuÃ§Ã£o por etapa
- Erros e warnings detalhados

### ğŸ“‹ **Exemplo de RelatÃ³rio**

```
=== RELATÃ“RIO DE VALIDAÃ‡ÃƒO ===
Entidade: clientes
Pipeline: firebird_to_sql
Data: 2024-01-15 14:30:00

ğŸ“Š EstatÃ­sticas:
- Total de registros: 1,234
- Conformes: 1,180 (95.6%)
- Divergentes: 54 (4.4%)
- Tempo execuÃ§Ã£o: 2m 34s

ğŸ” Principais DivergÃªncias:
- DFcnpj_cpf: 32 registros (2.6%)
- DFinscr_estadual: 22 registros (1.8%)
```

---

## ğŸ” SeguranÃ§a

### ğŸ›¡ï¸ **PrÃ¡ticas de SeguranÃ§a**
- **Credenciais**: Nunca versione arquivos de credenciais
- **Logs**: NÃ£o registre dados sensÃ­veis em logs
- **ConexÃµes**: Use conexÃµes seguras (SSL/TLS)
- **PermissÃµes**: Acesso somente leitura nos bancos origem

### ğŸ”’ **ConfiguraÃ§Ã£o Segura**
```python
# config/credentials.py
import os
from dotenv import load_dotenv

load_dotenv()

DATABASE_CONFIGS = {
    'firebird': {
        'host': os.getenv('FB_HOST'),
        'database': os.getenv('FB_DATABASE'),
        'user': os.getenv('FB_USER'),
        'password': os.getenv('FB_PASSWORD')
    }
}
```

---

## ğŸš€ Roadmap

### ğŸ”® **PrÃ³ximas Funcionalidades**
- [ ] **Dashboard Web** com mÃ©tricas em tempo real
- [ ] **API REST** para integraÃ§Ã£o com outros sistemas
- [ ] **Agendamento automÃ¡tico** de validaÃ§Ãµes
- [ ] **NotificaÃ§Ãµes** por email/Slack
- [ ] **Suporte a Oracle** e **PostgreSQL**
- [ ] **ValidaÃ§Ã£o de relacionamentos** entre entidades
- [ ] **Machine Learning** para detecÃ§Ã£o de padrÃµes

### ğŸ¯ **Melhorias Planejadas**
- [ ] **Performance**: Processamento paralelo
- [ ] **Interface**: MigraÃ§Ã£o para web (Flask/Django)
- [ ] **Testes**: Cobertura de testes automatizados
- [ ] **Docker**: ContainerizaÃ§Ã£o da aplicaÃ§Ã£o
- [ ] **CI/CD**: Pipeline de integraÃ§Ã£o contÃ­nua

---

## ğŸ¤ ContribuiÃ§Ã£o

### ğŸ“ **Como Contribuir**

1. **Fork** o repositÃ³rio
2. **Crie** uma branch para sua feature (`git checkout -b feature/AmazingFeature`)
3. **Commit** suas mudanÃ§as (`git commit -m 'Add some AmazingFeature'`)
4. **Push** para a branch (`git push origin feature/AmazingFeature`)
5. **Abra** um Pull Request

### ğŸ› **Reportar Bugs**
- Use as [Issues](https://github.com/Pablo-Raizer/Validador-Dados/issues)
- Inclua detalhes do erro, ambiente e steps para reproduzir

### ğŸ’¡ **Sugerir Melhorias**
- Abra uma [Issue](https://github.com/Pablo-Raizer/Validador-Dados/issues) com label `enhancement`
- Descreva o caso de uso e benefÃ­cios

---

## ğŸ“ Suporte

### ğŸ†˜ **ResoluÃ§Ã£o de Problemas**

#### **Erro de ConexÃ£o com Banco**
```
Erro: NÃ£o foi possÃ­vel conectar ao banco
SoluÃ§Ã£o: Verifique credenciais e conectividade
```

#### **Erro de PermissÃ£o PowerShell**
```
Erro: Execution Policy
SoluÃ§Ã£o: Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
```

#### **Erro de ImportaÃ§Ã£o**
```
Erro: ModuleNotFoundError
SoluÃ§Ã£o: pip install -r requirements.txt
```

### ğŸ“§ **Contato**
- **Desenvolvedor**: Pablo Raizer
- **GitHub**: [@Pablo-Raizer](https://github.com/Pablo-Raizer)
- **Issues**: [Validador-Dados/Issues](https://github.com/Pablo-Raizer/Validador-Dados/issues)

---

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ sob a licenÃ§a **MIT**. Veja o arquivo [LICENSE](LICENSE) para mais detalhes.

---

## ğŸ™ Agradecimentos

- **Equipe ERP Director** pelo suporte e feedback
- **Comunidade Python** pelas bibliotecas utilizadas
- **Contribuidores** que ajudaram a melhorar o projeto

---

<div align="center">
  <p>Feito por <a href="https://github.com/Pablo-Raizer">Pablo Raizer</a></p>
  <p>â­ Se este projeto te ajudou, considere dar uma estrela!</p>
</div>